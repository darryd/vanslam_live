self.addEventListener("message",function(e){function s(){self.web_sock=new WebSocket(self.url),web_sock.onmessage=function(e){self.postMessage({type:"message",data:e.data})},web_sock.onopen=function(){self.web_sock.send(JSON.stringify({type:"subscribe",competition_id:self.competition_id})),self.postMessage({type:"connected"})},web_sock.onclose=function(){t()},web_sock.onerror=function(){t()}}function t(){var e=100,t=setInterval(function(){self.web_sock.readyState==WebSocket.CLOSING||self.web_sock.readyState==WebSocket.CLOSED?s():clearInterval(t)},e)}function o(e){self.web_sock.send(e)}var n=e.data;switch(n.type){case"url":self.url=n.url,self.competition_id=n.competition_id,s(),t();break;case"send":o(n.data)}},!1);
